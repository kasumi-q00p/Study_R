<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>10. 発展的なトピック - Rで学ぶ生物統計学とデータ可視化</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        h1, h2, h3 {
            color: #2c3e50;
        }
        code {
            background-color: #f4f4f4;
            padding: 2px 4px;
            border-radius: 4px;
        }
        pre {
            background-color: #f4f4f4;
            padding: 10px;
            border-radius: 4px;
            overflow-x: auto;
        }
        .note {
            background-color: #e7f3fe;
            border-left: 6px solid #2196F3;
            margin-bottom: 15px;
            padding: 4px 12px;
        }
    </style>
</head>
<body>
    <h1>10. 発展的なトピック</h1>

    <p>このセクションでは、Rを使用した生物統計学とデータ可視化の発展的なトピックについて学びます。</p>

    <h2>10.1 Rパッケージの紹介（Bioconductor等）</h2>

    <p>Bioconductorは、生物学的データの解析に特化したRパッケージのコレクションです。以下に、いくつかの重要なパッケージを紹介します。</p>

    <ul>
        <li><strong>DESeq2</strong>: RNA-seqデータの差異発現解析</li>
        <li><strong>edgeR</strong>: RNA-seqやChIP-seqデータの解析</li>
        <li><strong>limma</strong>: マイクロアレイやRNA-seqデータの解析</li>
        <li><strong>Biostrings</strong>: 生物学的配列の操作と解析</li>
        <li><strong>GenomicRanges</strong>: ゲノム座標の操作</li>
    </ul>

    <p>Bioconductorパッケージのインストールと使用例：</p>

    <pre><code># BiocManagerのインストール（まだの場合）
if (!requireNamespace("BiocManager", quietly = TRUE))
    install.packages("BiocManager")

# Bioconductorパッケージのインストール
BiocManager::install(c("DESeq2", "edgeR", "limma"))

# パッケージの読み込み
library(DESeq2)
library(edgeR)
library(limma)

# 使用例（DESeq2）
# 注: これは概念的な例です。実際のデータを使用する場合は適宜調整してください。
dds <- makeExampleDESeqDataSet(n=1000, m=12)
dds <- DESeq(dds)
res <- results(dds)
head(res)
</code></pre>

    <h2>10.2 レポート作成（R Markdown）</h2>

    <p>R Markdownを使用すると、Rコード、その出力、および説明文を1つのドキュメントにまとめることができます。これは再現可能な研究レポートを作成するのに適しています。</p>

    <p>R Markdownの基本的な使用例：</p>

    <pre><code>---
title: "生物統計学レポート"
author: "あなたの名前"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## はじめに

このレポートでは、サンプルデータの統計分析を行います。

## データの読み込みと前処理

```{r}
data <- read.csv("sample_data.csv")
head(data)
```

## 統計分析

```{r}
model <- lm(response ~ predictor, data = data)
summary(model)
```

## 結果の可視化

```{r}
library(ggplot2)
ggplot(data, aes(x = predictor, y = response)) +
  geom_point() +
  geom_smooth(method = "lm")
```

## 結論

分析の結果、...
</code></pre>

    <div class="note">
    <p><strong>注意：</strong> R Markdownを使用するには、<code>rmarkdown</code>パッケージをインストールする必要があります（<code>install.packages("rmarkdown")</code>）。RStudioを使用している場合、R Markdownのサポートが組み込まれています。</p>
    </div>

    <h2>10.3 バージョン管理とリポジトリの使用</h2>

    <p>バージョン管理システム（例：Git）を使用することで、コードの変更履歴を追跡し、共同作業を効率化できます。以下は、Gitの基本的な使用例です。</p>

    <pre><code># Gitリポジトリの初期化
git init

# ファイルをステージングエリアに追加
git add analysis.R

# 変更をコミット
git commit -m "初回の解析スクリプトをコミット"

# リモートリポジトリを追加（例：GitHub）
git remote add origin https://github.com/username/repository.git

# 変更をリモートリポジトリにプッシュ
git push -u origin main
</code></pre>

    <div class="note">
    <p><strong>注意：</strong> GitをRプロジェクトで効果的に使用するには、<code>.gitignore</code>ファイルを適切に設定し、大きなデータファイルや機密情報をリポジトリから除外することが重要です。</p>
    </div>

    <h2>まとめ</h2>
    <p>これらの発展的なトピックを習得することで、より効率的で再現可能な生物統計学研究を行うことができます。Bioconductorパッケージを活用して高度な解析を行い、R Markdownでレポートを作成し、Gitでバージョン管理を行うことで、研究のワークフローを大幅に改善できます。次のステップとして、これらのツールを実際のプロジェクトに適用し、経験を積むことをお勧めします。</p>

</body>
</html>
